From 1a580d2a948add6fee102df90357d2b46d4a99ed Mon Sep 17 00:00:00 2001
From: Eilo <eilo2518@gmail.com>
Date: Mon, 13 Feb 2012 04:10:49 -0500
Subject: [PATCH 45/67] =?UTF-8?q?2.2.41=20ICC:=20Saurfang=20a=C3=B1adido=20e?=
 =?UTF-8?q?l=20da=C3=B1o=20periodico=20de=20Marca=20del=20Campeon=20Caido?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../IcecrownCitadel/boss_deathbringer_saurfang.cpp |   19 +++++++++++++++++++
 1 files changed, 19 insertions(+), 0 deletions(-)

diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_deathbringer_saurfang.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_deathbringer_saurfang.cpp
index a1e45a2..7a93452 100755
--- a/src/server/scripts/Northrend/IcecrownCitadel/boss_deathbringer_saurfang.cpp
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_deathbringer_saurfang.cpp
@@ -407,6 +407,25 @@ class boss_deathbringer_saurfang : public CreatureScript
                 if (me->HasUnitState(UNIT_STATE_CASTING))
                     return;
 
+                // Daño periodico de la Marca del Campeon Caido a los players
+                if(me->isAttackReady())
+                {
+                    uint32 Markdmg;
+                    Markdmg =  urand(5700,6300);
+                    int Markdamage = Markdmg;
+
+                    Map::PlayerList const &pList = me->GetMap()->GetPlayers();
+
+                    if (pList.isEmpty())
+                        return;
+
+                    for (Map::PlayerList::const_iterator i = pList.begin(); i != pList.end(); ++i)
+                        if (Player* player = i->getSource())
+                            if (player->isAlive())
+                                if (player->HasAura(SPELL_MARK_OF_THE_FALLEN_CHAMPION))
+                                    me->CastCustomSpell(player, SPELL_EFFECT_MARK_DMG,&Markdamage, 0, 0, true);
+                }
+
                 while (uint32 eventId = events.ExecuteEvent())
                 {
                     switch (eventId)
-- 
1.7.8.msysgit.0

